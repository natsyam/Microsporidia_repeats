# **Part 7. Phylogeny tree of sakhalin001 sample's repeats**

Laboratory journal: [Repeats_in_S001](https://colab.research.google.com/drive/1CiicJw9VgY_yLFeN4hovIILxxie-TTyd?usp=sharing)

## **Main Points**

- The study focused on the **sakhalin001 sample** and its "unknown" repeats.
- Short sequences and simple sequence repeats (SSR) were filtered out.
- Repeats were clustered using CD-HIT, and clusters contributing >0.1% of the genome were selected.
- Eight ORFs were detected in this cluster, but they are small and likely non-functional, requiring further investigation.

## **Introduction**

In this section, the focus was placed exclusively on repeats from sakhalin001 sample, that represents a new branch on the microsporidium phylogenetic tree and has a sufficiently large genome for an intracellular parasite. The study followed a comprehensive plan beginning with the extraction and preparation of "Unknown" repeats, followed by filtering out short sequences and simple sequence repeats (SSR).

Next, the analysis involved clustering using CD-HIT and estimating the coverage of each cluster. Prior to alignment, only clusters contributing more than 0.1% to the genome were selected. The selected clusters were then aligned using MAFFT, and a phylogenetic tree was constructed with IQ-TREE.
However, no large clusters have been identified that would occupy most of the genome.

## **Methods**

**Plan**:

- De novo repeats identification using RepeatModeler+RepeatMasker
- Extracting and preparing "Unknown" repeats
- Filtering of short sequences and simple repeats (filter those have >30% simple repeats based on TRF output)
```
seqkit seq -g --min-len 200 unknown_repeats.fa > unknown_200.fa
trf s001_unknown_150.fa 2 5 7 80 10 50 1000 -l 10 -d -h -m > trf_s001_solo.txt
```
- Clusterization (CD-HIT)
```
cd-hit-est -i s001_filtered.fa \
           -o s001_filtered_cdhit \
           -c 0.80 \
           -n 4 \
           -d 0 \
           -M 16000 \
           -T 2
```
- Cluster coverage estimation
- Alignment (MAFFT)
```
mafft --auto s001_plus_outgroup.fa > aligned_s001_outgroup.fasta
```
- Building a tree with IQ-TREE (LINE/CR1 as an outgroup)
```
iqtree -s aligned_s001_outgroup.fasta -m TEST -bb 1000 -nt AUTO -o DNAMerlin_69,DNAMerlin_384,DNAMerlin_385
```
- Selection of "interesting" families and a BLAST test

## **Results**

**De novo repeats identification**

Repeats occupy 40% of this organism’s genome, with 16% being previously unknown. On the Kimura distribution graph (Figure 1), the peak is observed at 15, indicating a predominance of ancient or inactive repeats.

```
==================================================
file name: s001.fasta               
sequences:         48272
total length:  100637920 bp  (100606820 bp excl N/X-runs)
GC level:         19.78 %
bases masked:   38977041 bp ( 38.73 %)
==================================================
               number of      length   percentage
               elements*    occupied  of sequence
--------------------------------------------------
Retroelements         1222      1230507 bp    1.22 %
   SINEs:                0            0 bp    0.00 %
   Penelope:             0            0 bp    0.00 %
   LINEs:               86        74843 bp    0.07 %
    CRE/SLACS            0            0 bp    0.00 %
     L2/CR1/Rex          0            0 bp    0.00 %
     R1/LOA/Jockey       0            0 bp    0.00 %
     R2/R4/NeSL         86        74843 bp    0.07 %
     RTE/Bov-B           0            0 bp    0.00 %
     L1/CIN4             0            0 bp    0.00 %
   LTR elements:      1136      1155664 bp    1.15 %
     BEL/Pao             0            0 bp    0.00 %
     Ty1/Copia           0            0 bp    0.00 %
     Gypsy/DIRS1      1136      1155664 bp    1.15 %
       Retroviral        0            0 bp    0.00 %

DNA transposons      30997     18161221 bp   18.05 %
   hobo-Activator     1904      1507244 bp    1.50 %
   Tc1-IS630-Pogo     5809      2962222 bp    2.94 %
   En-Spm                0            0 bp    0.00 %
   MULE-MuDR          5798      4217765 bp    4.19 %
   PiggyBac            216       114850 bp    0.11 %
   Tourist/Harbinger     0            0 bp    0.00 %
   Other (Mirage,        0            0 bp    0.00 %
    P-element, Transib)

Rolling-circles          0            0 bp    0.00 %

Unclassified:        49216     16578898 bp   16.47 %

Total interspersed repeats:    35970626 bp   35.74 %


Small RNA:               0            0 bp    0.00 %

Satellites:              0            0 bp    0.00 %
Simple repeats:      45192      2268045 bp    2.25 %
Low complexity:      14380       738370 bp    0.73 %
==================================================
```
*Figure 1. Kimura plot*
<img width="1371" alt="Снимок экрана 2025-02-28 в 14 07 28" src="https://github.com/user-attachments/assets/6f2b2895-f4d6-4c99-9de5-5dd77e53d218" />

**The phylogenetic tree**

A phylogenetic tree was constructed for 26 repeat clusters, each accounting for more than 0.1% of the genome, using repeats from the DNA/Merlin family—identified in this organism—as an outgroup. The tree is supplemented with data on the percentage of the genome each cluster occupies. 

*Figure 2. Visualization of phylogeny tree*
<img width="1127" alt="Снимок экрана 2025-02-28 в 14 54 51" src="https://github.com/user-attachments/assets/11a171fd-4493-4d67-aecd-f6a56522dbc3" />

However, the alignment visualization remains suboptimal, likely due to the simultaneous analysis of different repeat types and the lack of an ORF (open reading frame) screening within them. Considering that repeats evolve much faster than the ORFs they contain, a more appropriate approach would have been to construct the tree based on more conserved regions of the repeats.

---
**Cluster 1 (occupies ~0.75% of the genome)**

As seen from the tree, there are no repeat clusters in this organism that stand out by the proportion of the genome they occupy—the largest cluster barely reaches 0.75%. Analysis of its representative sequence for ORFs revealed numerous small ORFs, which are unlikely to have functional significance.

*Figure 3. ORFs that was found in rnd-1_family-3#Unknown*
<img width="1229" alt="Снимок экрана 2025-02-28 в 15 15 07" src="https://github.com/user-attachments/assets/d423116a-da37-4bd5-a549-135317ea5a80" />

The longest one, when subjected to a BLAST search, yielded the following results.

Consesus sequence for cluster 1:
```
>rnd-4_family-681#Unknown ( Recon Family Size = 89, Final Multiple Alignment Size = 73 )
GTGTATTTGTAATGATTTTNNAANCATTTAGTAGAACGATAATAAAAAACCATTTTAATT
TTATATAGTAAAGTTTGTTNTATAATAATAAACCAAANTNTTATTTTTATAAAATAAAAA
AAATTCATGCTTGTTTTTTATTATTNTAATGTAAAAAAACATAAAAATTATTTTATATAT
TCAAATGTAAAATTACACACATAATTCAAAGGAAAACACAAATGTAAAAAATATTTGAAT
GTAGCAAAGTACATGTTTGATATATAAAAACGAATTAATNCATAAAAATAANAATGTGTT
TTGTAAAATGAATATAGAATACACATTTTATATATAAATAAAANAATTGTANATAATATT
TTGATGTTTATAATTTATTACCNGTGTTGAAAGNTTCTATATATTGTTAAAACATAAATA
ATTAATAATTGCAGTTTTTTCGTCTATGTGTGTAATATAATATAAATGTTTTGAATTAAA
TCATTAATGTACAATTTATTGTAATATTATCGTAATATTTTTATGAAAAATANATTAGAA
TTTTAAACTTAAATCCANCATAAATTATGCAATTAATACAATCACANGTAAATGATCACT
TTCTATCAAAAAAATATGATATACAATATTTGCAAAACACAAAAATTACAAAATAAACAA
TAGAAAATACAATNTTAATATTTTATATATTGACTTGTAATTTATNAATGTTTATATTGA
GATGTTTGATTTTTTCAATTTTTAAATAANTATATTCATANATCANATAAAATTTTTNTT
ATTTTATCAAATTATTAAATTTTTTTTAANTATATAATTACATTNTACANTATCATACNT
TTTTAAAATATTTTTTTTACAAAACGCAAAACTGAATAGAAAAAATTACAAACAAATTAA
GATGTTAAATCATTGTGTTTTTTGTTAGTTAAATTGTTATACAATACANAANTTCGATAA
TGTTAAAATNTTTTTTTATAACTATTAGCAATATGTAANTATTGTATTTAGAGCATAAAA
AATACACAGATTTAATAAACATAACATTATANTTGTTTTTTAATCTNTTAATCATAAAAA
TTNTAAATAATAATAAATAAATAATTTAAAATTAATAGTATAAATGTAATTTTAATATAC
GTTTTTATAAANTCTAACATTTAACTTTAAACTGGAAACGTGCAATATATTTACACGCCT
ATCCATTTATACAAATATGTAATAAGCATATGTNCACATTATCCTACTACTAATTTAGTA
CATTAGTAAATATGCATTATTTACAANTAGCACGAATTGTTTTAATATTTTTTTTTATTT
TTCATTATTTATAAAATACAATAGAATTGTATATAATAAATATATTGGTATATTATGAAA
TTTTTTAAAANAAATTTGTAAAATTTCACGAATTAAAACGCATAATTTGCAAATCTGATT
TATAAATTAGAAAATTTATNTTTTTTGTTTATACTATTATTTTTTAANAGTACATTATAT
GTGTATGCTTTAGAAAAAACATTGCTTTAAAGTTACAATTTATATTGTATGCAATAAAAA
ACATTACATTTATTTTTTTCAATAAAAATGTTTTATATATATTTTTTATAAAATATATGT
TTGTACCGACTAGATTTAAAACACGGATGTGCATTAAACTTTAAATNCTTTATTTTTTTG
AGAATCAAAGCATTATTGACATTACCTGCCGAAATAGAATTATCATTAAATATACATTAA
TATAACAAAAGTCATGTATATCGTAACATGCGTTTGTTGTAGACATTTGCATTTTATTAT
TTATATAAAAAACATATATCATTTTCAATTTATGCAAATAAAATTTTGCTTTTTAGATAC
TAAATTTGGTTTATAACTATAATTATTTATTATGGACGTACGTTATAATGCCGTTAAAAA
AGTGTAATAACAATTTTTATTAAAAATCCAGATATATCAAATGTTTGAATAATATGACCA
ATGTTTAATATTTAAAAAATTTAGTTACATATTCATTTTATATTAACCATCTTACTATAA
AAACTGGTAGGAGCTAATAATAGAAATGCTAATNGGTAAAACAATAATAATGATATAATT
TCTATTTGGTTATTATTATAGAAATGAAATTNTTAGCAATAATTTTGCTTACTTGTATAT
AACAAATATCTGAGTAAATAAAAACAATATATAAAGAGTTTCATGCATGTTTTAATATAA
AAANTAAATATATNTAAAAACAATTGAATTATATACATAATAAAATATATATATAAAATA
TAATTAAAATAGTATAGATACAAAATAAATACGCGTATTGCGTTTTTTATAATATTTTTT
ATTTTGCTCTTCGAGAAACTTTTAAGTCATGAATATGGATACAATCAACACATCCGAAGT
TTCAACGTTTTAAAGCNAAAACGTTGTACTTAGAAAACTTTGTCTGTGATCANTACAACT
GGAAATATATATATTTGCATTGGATACCAACATGGTTACATTTTTTATCGTGTTATTACT
AAATGCAATTGACTGATATTTGGCTTCAATTAACATATTTTATGTAAAAATAAAAAGAAT
AAATCTGACGTTGTGTTATGAATTTGCTCTAACAATAGCATCAANTCTTCTATTTAAAAT
AATNATATCAGAAATATTNANTCACAATATAATTAGTTATTGTATAAAGCAATTTTNTTG
GATTGTTATATATAATATAAATTTATTGAATATGAGTAAGGTCAAATGGTTAATATAACA
TAATAATCATGTTTATAAAAAAAATATCAAATATAAAATGGCATTTATATATAAATTATG
TAACNATAATTAAGTATTTACAAACCATTTATTGCACATAGAACTTGCCATTTTTAGGTA
ATTTNAATAATAGTTTTTAAAAATATATAAACATACAATATCAAACCATATATACTTTTT
AAAATATATATTTACAATTAAGAGAACAATATTGCAATATATTAACACGATCATTCATAC
AAATGACTTTATTTTTTACTTTTATAAAATTTTNGATATATCATTGTTTATTTGAATAAA
AAATTTAATTTAGCTATATATAAAATGCAAAGTCAATCTAATTTTTATGTTACTAAGAAT
ANCAATCAACAAAAGAAACANANCTAATTAATGTATTATCGATGTAAATAATAAAAAATT
TTCATACCAAATAAAATAACTAAATGCGAACAACAATAACAGATTAGCAATAAACAAAAT
CTGTTATTTAAAAAACTCCCAAGTCTTGAAATAATTTTTTATTAAATATAAAATTTATTT
TATAATGTATCATTTATGATCTTATATGTTGTACATTATAAAATAAAAACTATTACTCAA
NATTATTTGTGTTAAAATTTNATCAAAAAANCTATGTTTTAATATTACATTATNGNTATT
AGTATTTAAATACATCATATAAATAAATGTTTATAAAAATAATATAAATAAAGTAATGTT
ATTTATANAATTGTTAAAAAATTTACATAAACATTTAATAAGTAATAATAATTTANTTTA
TTTGTATCAATTAAGTATACANANACAATTTAATTATATAAACAAATNTTGTTTTAAATA
TATAGATTATAATTATTGTGTGCAATTTTGTTATATTATAATAGGAACGATATATAAAAA
TTNNATTTTTTATACNATTAATAATTTTAAACAAATTTNTTAAATTAAAATAAAAAATTA
ACAAATTTATTATATATCATTAGNTAATTAAATACCAANAANATAGTCAACACATAANCA
TGATTTGCAANAATGTTAAATTATATATTTATTACAAATGATTTATTATTATTAAATATA
ATTATTTATCATTGAATTCATACATTTATATATAATTAAATTTATTTTATAATATTAATT
TTTTTATAATTTGATTAAATAATTAATTTTTTGTTAGTTATATAAATATGTTTAAATTTT
ATTTTAGAGTTGCAACTAAAATTAAGNTTATAATCGAGATANATTATAAACATCAGNNTC
AATTATATATTTAAAATTATACAAATGTTATTTTTTACATAATGATACTAATATTATCAA
TGTAAAAATAGTATTAATAAAAAGTCTTNTAAATTTAAAATCAAAACAAATTTTTTTAAA
ATTTCTACATTTGATTATAATATCTGAATTTCATCATGTTTAATTGTATACATATNTAAG
TTGTATTGAGTAATNTGTAAATAAATTATATAATTTACATACGTANNATTAATTTATTAC
ATATGTATTANTATTATTTTTGTAAAAAAAATTTTATTAGCAAAAACTATATTTTTATCA
TATAGACGTTTTACTATATATGTGTTTTGTTTGTTTCATGCAAAATGTATTATAATAAAT
TTGCTTAAATGATATATATGTTACTGCATATTATTCAAAATANGATTATTATAGCAATTG
ACTTTTGTTGTATTTTTTTATTAATATACAATTATTGATTATATANTAAATTTAAATAAT
AAATTATANAATGTGTTGTTGTANAATACATTGAACAAAAAATTAGACACATCATACAAN
TTAATTCTAATTAAAATATATAAAAAATAAANGTTTAATAATTAATTATACTTTANAACA
TTTNTATANCATAAATTTNATAAGCTATGCTTAATGTTACTTGATGTATATTTNATTTTA
CACTTACAAATACATTGTGTAAACATAGCATNTTTTTTTATTCAATTATAAAATATTAAT
CANTACAATTTCTTTANCAAAAAAATAACAATTTTNANTATATCATATTACAAACGCCAA
AAAANATATAACTCAAATGTTCAANAAATGTGTTATATTTAGTAAATACGATTTGATATA
AAGCNTGATATATTNATTTGTTNATGCAAACCCATAAATTTATATAAACAACATTTCAAT
ATAAATGATTTTATTTATTAATTATATTTTATTGGTTGACNAATAAAACATAAACGTGAA
ACTGATTGATTAATCATTTTTGTCATATGGCTNATACCACCAANATTAATATCAANGTAT
TGTTAATTATTATAATCGAACAAAAATGTTATATAGTTTTTTTAAAAAAATTGTATACTA
GTTTTAAAGACAAAGCTAATTTGTTATTATATAGAAAAAATNTAAATACTTGTATAAAAA
CCATACAAAATTAATATAATGACAAAGTATTATAATAATAAAATGTGGTTTAGCNTATCC
AAAGTCGTGTACTAAAAAAAAATCAATACGTATGTGTATTTTATATAAAAAAATGTTGCA
TTTTCAATTTTTTACGCAACTTATAAATATTTATATATACTGTGTGTCAAAAGTAAACAA
GCAAACCTGTTTTGCAAACCANAAATGAAATTAAAAATTTACCAATCAAAAAAATTTATT
TTTAAACCAAATTTGAAAAAGACCCATTNATTTACTCGTTNTTGTCAACTATCAAATCAA
ACTTTGGTTAAAAATCAAAAAAATACACGTATCATGTATTTGTTTGTTTTGATTANAAAT
TTCGTATTTATTTTTATTAATAACAACCGNTTTGCATAAATATGTTGTTGACAATAAAAA
GTACTTTTTGGTTCGATGGCGANAATACGTAAAAACCATGGAATAGCAAGNCAAAAANCA
TATATTNTTGATAATTCNTTAAAAACTTGNTTATTTTATCGNTGTTTANAGTTCAATTAA
TAACTTNATGTGCTTTTATTACTTTTACTCGCTTTAAAATTAAATTGACAAATAAATCGC
TCATTTTTAATTATTGATCCGTGNATTTGTATTAATAANTTAANTTATTTTATCATTGTT
GATAATTTTATATNAACANAATGCTTAAATATTGTATTTTTTTCGGCTTGAGTGTTATGG
TATATTAAANTTTTTNACATTTCAAATAAATCATTTTTAGCTTTTTCAATCNAAACATAC
TTATTTTTCAACGCGTAAATTTTATTAGCATATTTAAATAAAATTTGNTTTTTTTGTANT
AATAAATTTAGCGGTAAAAATTTCATTAATTTTACATTANTATGCAAGTAGGGCTATTCA
ATCACCGTCTTCGACTTTATGACAAAAACATGNNTTTTTAAAAAAAATATATATTTTTTT
ATATTAAAANTTTCTTGAATGAATGCCTCTTTGATAACCATCAAANTTTAGTGCGCATGA
TAATTGAATTTAAATATTANTTGCGTGTTTGCACAATTGTANAATAATCTATTATTTANA
GCATTAAATTTTACAAAATAAACATATTAANAATTTTAAAAAAAATTTGCTTGTANTTCG
ACGCCATTTATAATTTTTATATAATTTTTGANACATCATGCAACATGTTAAAACGCATTT
AAAACCACATTCTTTATTTTGGTGTTAAACCTAAACGTTTTGTCTAGTCATTGATNCGGC
ATTATTAANNTATTATTTCAACGCAATAAATTTAAAATAGATATTTTAACAATTGAAGTT
ATTTTGTGTACGATCATTTCAAATTTTAGTGGTGTTTGTGGGCAGCGAAATCAAACGCAA
ACAATTTTTTTTAGNTGCTTGTTTTAAACAAATGCTTCATATATACGATTTACATCGATT
ACATAAATTTATTTTATATTTTTGTAATTGTATCCAATTAAAGCACGAATTATTGTGATT
TTTGANTCGGCATAAANTCTGATTTTTGTTATTTCGNAAATTTTTAAAATTTAACGTTTA
GCTGTATTTTTANAACATGGTNTTTCAAAACACATTTTTTGCATATAGTTTTTGTATCGA
CATAATTTATNTATGTAAATGCTTTATGAGCTGTCAGTTTTTGCATCCAATGAGAAATTT
AATAAAATGTATTCAATAGTTTTTTTGTCTGCTTTTAATGATTAAGTAGCAGTTTCTGAT
TTTTTTTATTAAAAAAAATANTAGTATTTGATTACATCTAATTAATGCATGATTTTATAT
GCGTTTAAAGTTTTGATCATTTTGTTGCATTATTTGACATTTTTTTTTAAAAAAATCAGA
AANAACAAGTATGTAANTAACTTCGATAAAAACAAACCCACGCATTATATTAATATTAAT
TTATTAAAATGNTTATCCGTCAAACATTATATTATTTTGAATGGTATTCTGTACAGAAAT
GNTGTTTTTTNTGTTGGAAATTAGATCAAGTCGTTTTCAGTTTTATAAAATTAAGCTACA
GAATATGTATTTTAATATTANTAAANAACGACAAAATGTAAATTACATTTGTAAATGTTG
TTAATAGTTCTGATTGTTATATAAAAAATGATTGGTTAATTTTAATTTGTATTTTGTTGA
TTTAATTTGTGATCTTNCAAATCTCGTTTTANAAAACCGAAAATTTGCTTTTTTAAATAA
ATTGCAAATTGCAGGTTTTTTCGANCTTGAGTGTAGGCTATGCCAAATTTACATNTTTTA
ATTAATAAATTGTAAAAAAAATTGTATTTTTTATGAATTTTCACTTAATAAAAATTTTGT
CAGAATTTAATACATTATAAACGTGAATGATCANACTATAAATTTTTTCATAAAAAATAT
ATATTAACAATATAAAACAATCGTTAAAATGGTTTTTTTAAAAATATTGGTTATACAAAT
ATACAAAAAAAAAATCATCGATGTTTAAATTGTGTGTTTATTGTTAATTGTAAAGTATGT
TATGTCTATATGTAAATTAATGACAAAAAAATTGTTTTTATTATACTACATATTTGTATT
TATTAATATTTATAATTATTTTAATAAAAAAATACAATATAAATTATTTACATTAATAAA
TCATTATATTTTTTATAGCATTGTGTTCAAATTAATACAACTTGNTTTGTTAAATTTTAT
ATTAATAAATATAAATTTTTTATAATGTATAATTTATTGCTGTTGTAACAAATGTTAATA
AAACANTAACAATAAATATCTAACGACATNTTTTTGAGCTTAATTTTAGAATTTNTTAAT
TTAAAAAATGACGACATATAAAACCACATTTTTTTTTAATTTGTGATAAATAGAATACTG
TAAATTGCAATTTTAATAATTCATAAATTGATTTTATATAAAAAAAATCTGATTTTTTTG
GTATTATTTTTTGTTTATATAAAATTTATATACATAATTTTTTATAATTGTTATGTTTTT
TTCAATTGATTTGTTTTTATATTTATTATTTAATTAATTGATAAAAAATTTATATAATAT
AAATTAACGTTAAATTTACAATTTTCGGGAATTTTAAATTAGCAACAATTTATAATAAAT
TTTGTATATTAAAAATTATTAAANTAATTAACTATATAAAAAATATGAAGTCAATTAATA
ATATTT
```
*Figure 4. Motifs that was found in cluster 1*
<img width="1358" alt="Снимок экрана 2025-03-16 в 14 43 09" src="https://github.com/user-attachments/assets/a3dbd1d6-b5a1-4f4a-80b7-44edb8a89907" />

